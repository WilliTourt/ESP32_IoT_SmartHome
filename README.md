# ESP32智能家居控制平台

这是一个基于ESP32微控制器的物联网项目，它通过Web服务器提供用户界面，用户可以通过浏览器在局域网范围内控制家中的其他ESP设备。系统包含灯光控制、窗帘操作、温湿度监测、门禁密码设置、定时任务、闹钟等功能。通过主从设备架构，主控ESP32能够与多个ESP8266子设备通信，实现对更多智能设备的控制，构建一个灵活、易于扩展的智能家居系统。

_**这个项目部分程度上是为了验证可行性做的**，所以目前它只包括了比较基础的功能，像是自动窗帘和实体门禁这种有点麻烦的东西就没有实装，而是用舵机做做实验后就删除了。代码中还有很多粗糙的部分，比如两个定时任务设置，第二个定时器就是直接用第一个定时器ctrl cv出来的..._

本项目开发过程中顺便参加了校单片机应用设计赛，并获一等奖。参赛作品文件为Contest.zip，功能和下述项目稍有不同，供参考。[视频链接](https://www.bilibili.com/video/BV1Rck4YLEDo/?vd_source=a8b94f97393f728f56b73fabed0689a5)

---
## 项目思路：
  - 以一个ESP32作为主服务器，建立控制网页。（称为主设备）
  - 根据家中实际情况使用数个ESP设备作为子服务器，并根据自己功能建立路由。（称为子设备）
  - 主设备在收到来自网站的请求后，再作为客户端向其他子设备发送对应请求，控制连接到子设备的硬件。
  - _**注意：** 因为是验证可行性，所以让主设备以客户端的方式向其他子设备发送请求。实际上直接用浏览器向子设备fetch就行了，而不是让主设备作为中介。_

...以此可以建立家庭物联网，使用浏览器控制不同位置的设备

#### 主设备：
- **硬件组成**：
  - ESP32-C3 FH4 主控板 (只是我的选择，其他ESP32设备均可)
  - 128*64 OLED
  - DHT22 温湿度传感器
  - 蜂鸣器
  - 按钮
- **软件功能**：
  - 建立Web服务器，处理来自浏览器的请求
  - 控制灯光开关
  - 提供温湿度数据
  - 设置和触发闹钟
  - 切换设备显示模式（正常/夜间）
  - 设置门禁密码
  - 显示所有设备状态
#### 子设备：
- **硬件组成**：
  - ESP8266 主控 (个人选择了低成本的ESP12F)
  - 继电器 (家庭电路控制)
  - 根据功能连接的其他特定硬件
- **软件功能**：
  - 接收主设备的指令
  - 控制连接的硬件设备
  - 反馈设备状态给主设备

## 文件结构：
  本项目使用VSC PlatformIO扩展进行开发。使用了Arduino框架。
  - ESP32.zip:
    - data文件夹中存放主设备的网页文件，上传在主设备的flash中。
    - include和src存放头文件/源文件。
    - (以及其他PIO相关配置文件，其中.pio内有三方库文件依赖）
    #### main.cpp：
      WiFi连接，服务器路由，NTP时间同步，外设设备等
    - ExternalDevices.h：初始化外部设备
    - i2c.h：I2C通信的基础函数
    - oled.h：OLED显示
  - ESP8266.zip同理

---

*本人为大一学生 此项目需要进一步开发优化 大家主要还是参考就好*
